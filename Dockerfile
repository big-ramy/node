# 1. ابدأ من صورة Playwright الرسمية التي تحتوي على Node.js v20
# هذه الصورة تأتي مع المتصفحات وكل الاعتماديات مثبتة مسبقًا وجاهزة،
# مما يغنينا عن خطوات التثبيت اليدوية الطويلة (apt-get و npx playwright install).
FROM mcr.microsoft.com/playwright/node:v1.44.1-jammy

# 2. تعيين دليل العمل داخل الحاوية (تمامًا مثل ملفك القديم)
WORKDIR /app

# 3. نسخ ملفات package.json و package-lock.json أولاً
# (هذا يستغل ميزة التخزين المؤقت في دوكر لتسريع عمليات البناء المستقبلية)
COPY package*.json ./

# 4. تثبيت تبعيات Node.js فقط (بدون تبعيات النظام أو المتصفح)
# نستخدم npm ci لأنها أسرع ومخصصة لبيئات النشر (تمامًا مثل ملفك القديم)
RUN npm ci --omit=dev

# 5. نسخ باقي ملفات التطبيق إلى مجلد العمل (تمامًا مثل ملفك القديم)
COPY . .

# 6. تحديد المنفذ الذي يستمع عليه تطبيقك (تمامًا مثل ملفك القديم)
# Render يتعرف على هذا تلقائيًا، لكن من الجيد تحديده
ENV PORT 8080

# 7. الأمر الذي يشغل تطبيقك عند بدء تشغيل الحاوية (تمامًا مثل ملفك القديم)
CMD ["npm", "start"]
